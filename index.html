<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ูุธุงู ุญุถูุฑ ุงููุฑูุฒ V9</title>

  <link rel="stylesheet" href="style.css?v=9">

  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
</head>

<body>

  <div id="loginBox" class="card">
    <h1>ุฏุฎูู ููุญุฉ ุงูุณูุชุฑ</h1>
    <p class="muted">ุงูุฏุฎูู ูููุณุคูู ููุท</p>

    <label class="lbl">Username</label>
    <input id="user" class="inp" type="text" placeholder="ุงุณู ุงููุณุชุฎุฏู">

    <label class="lbl">Password</label>
    <div class="passWrap">
      <input id="pass" class="inp" type="password" placeholder="ูููุฉ ุงููุฑูุฑ">
      <button id="togglePass" class="eyeBtn" type="button" title="ุฅุธูุงุฑ/ุฅุฎูุงุก">๐๏ธ</button>
    </div>

    <button id="loginBtn" class="btn primary">ุฏุฎูู</button>
    <div id="loginMsg" class="msg"></div>
  </div>

  <div id="appBox" class="hidden">

    <div class="topbar">
      <div class="brand">
        ููุญุฉ ุงูุณูุชุฑ
        <div class="topStats">
          <span class="statItem clickable" id="openAllStudentsBtn" title="ุงุถุบุท ูุนุฑุถ ุงููุงุฆูุฉ ุงููุงููุฉ">
            ๐ฅ ูุณุฌููู: <b id="totalStudentsCount">0</b>
          </span>
          <span class="statItem">โ ุญุถูุฑ ุงูููู: <b id="todayCountTop">0</b></span>
          <span class="statItem">๐ฐ ุฅูุฑุงุฏ ุงูููู: <b id="todayRevenue">0</b></span>
        </div>
      </div>

      <div class="topActions">
        <button id="themeBtn" class="btn" title="ุงููุถุน ุงููููู">๐</button>

        <div class="termFeeWrapper">
          <span class="feeLabel">ุงููุทููุจ:</span>
          <input id="termFeeInp" type="number" class="feeInp" placeholder="0">
          <button id="saveFeeBtn" class="feeBtn" title="ุญูุธ">๐</button>
        </div>

        <button id="exportExcelBtn" class="btn">ุชุตุฏูุฑ Excel</button>
        <label class="btn fileBtn" for="importExcelInput">ุงุณุชูุฑุงุฏ Excel</label>
        <input id="importExcelInput" type="file" accept=".xlsx,.xls" style="display:none;">
        <button id="logoutBtn" class="btn danger">ุฎุฑูุฌ</button>
      </div>
    </div>

    <div class="grid2">
      <div class="card">
        <h2>ุณุฑูุน (QR)</h2>
        <p class="muted">ุชุณุฌูู ุญุถูุฑ ููุฑู ุจุฑูู ID.</p>
        <div class="row">
          <input id="quickAttendId" class="inp" inputmode="numeric" placeholder="ุงูุชุจ ID ููุง">
          <button id="quickAttendBtn" class="btn primary">ุณุฌู ุญุถูุฑ</button>
        </div>
        <div id="quickMsg" class="msg"></div>
      </div>

      <div class="card">
        <h2>ุจุญุซ ุดุงูู</h2>
        <p class="muted">ุงุจุญุซ ุจุงูุงุณูุ ุงูููุจุงููุ ุฃู ID.</p>
        <div class="row">
          <input id="openId" class="inp" inputmode="numeric" placeholder="ูุชุญ ุจู ID ูุจุงุดุฑ">
          <button id="openBtn" class="btn">ูุชุญ</button>
        </div>
        <div class="row">
          <input id="searchAny" class="inp" placeholder="ุงุจุญุซ ููุง...">
          <button id="searchAnyBtn" class="btn" style="display:none;">๐</button>
        </div>
        <div id="searchMsg" class="msg"></div>
      </div>
    </div>

    <div class="card">
      <h2>+ ุฅุถุงูุฉ ุทุงูุจ ุฌุฏูุฏ</h2>
      <p class="muted">ุฃูุชุจ ุฑูู ID ุฌุฏูุฏ ูุงุถุบุท ุฅุถุงูุฉ (ุณูุชู ูุชุญ ุงูุทุงูุจ ุชููุงุฆูุงู).</p>
      <div class="row">
        <input id="newId" class="inp" inputmode="numeric" placeholder="ุงูุชุจ ID ุฌุฏูุฏ (ูุซุงู 601)">
        <button id="addNewBtn" class="btn">ุฅุถุงูุฉ ููุชุญ</button>
      </div>
      <div id="addMsg" class="msg"></div>
    </div>

    <div class="card">
      <div class="flexBetween">
        <h2>ุญุถูุฑ ูุชูุฑูุฏ ุจุชุงุฑูุฎ</h2>
        <button id="copyReportBtn" class="btn success smallBtn">ูุณุฎ ุงูููุฎุต ๐</button>
      </div>
      <div class="row">
        <input id="reportDate" class="inp" type="date">
        <button id="reportBtn" class="btn">ุนุฑุถ</button>
      </div>
      <div class="badges">
        <span class="badge" id="reportDateLabel">ุงูุชุงุฑูุฎ: โ</span>
        <span class="badge" id="reportCount">ุนุฏุฏ ุงูุญุถูุฑ: 0</span>
        <span class="badge" style="color:#2ea44f;">ุฅูุฑุงุฏ ุงูุฎุฒูุฉ: <span id="reportMoney">0</span></span>
      </div>
      <div id="reportList" class="list mutedCenter">โ ูุง ููุฌุฏ ุญุถูุฑ ูู ูุฐุง ุงูุชุงุฑูุฎ โ</div>
    </div>

    <div class="grid2">
      <div class="card studentCard">
        <h2>ุจูุงูุงุช ุงูุทุงูุจ <span id="newBadge" class="newBadge hidden">ุฌุฏูุฏ</span></h2>

        <div class="studentHead">
          <div class="pill" id="studentIdPill">ID: โ</div>
          <div class="pill" id="todayStatus">ุงูููู: โ</div>
          <div class="pill" id="lastAttend">ุขุฎุฑ ุญุถูุฑ: โ</div>
          <div class="pill" id="daysCount">ูุฑุงุช ุงูุญุถูุฑ: โ</div>
        </div>

        <label class="lbl">ุงูุงุณู</label>
        <input id="stName" class="inp" placeholder="ุงุณู ุงูุทุงูุจ ุฑุจุงุนู">

        <label class="lbl">ุงูุตู / ุงููุฌููุนุฉ (ูุงู ููููุชุฑุฉ)</label>
        <input id="stClass" class="inp" placeholder="ูุซุงู: 3ุซ - ุณุจุช">

        <label class="lbl">ุฑูู ุงูููุจุงูู (ูุน ูุงุชุณุงุจ)</label>
        <div class="row">
          <input id="stPhone" class="inp" inputmode="tel" placeholder="01xxxxxxxxx">
          <button id="waBtn" class="btn success" style="width:auto; padding:0 15px;" title="ูุชุญ ูุงุชุณุงุจ">๐ฌ</button>
        </div>

        <label class="lbl" style="margin-top:20px; border-top:1px dashed #ccc; padding-top:10px;">ูุธุงู ุงููุตุงุฑูู</label>
        
        <div class="paymentBox">
            <div class="payRow">
                <span class="payLabel">๐ฐ ุฅุฌูุงูู ุงููุฏููุน:</span>
                <input id="stTotalPaid" class="inp" readonly style="background:#e9ecef; font-weight:bold; color:#2f6bff; width:100px; text-align:center;">
                <button id="correctPaymentBtn" class="btn warning smallBtn" title="ุฎุตู ูุจูุบ (ุชุตุญูุญ)">โฉ๏ธ ุฎุตู</button>
            </div>

            <div class="payRow">
                <span class="payLabel">โ ุฏูุนุฉ ุฌุฏูุฏุฉ:</span>
                <div class="row" style="flex:1;">
                    <input id="newPaymentInput" type="number" class="inp" placeholder="ุงููุจูุบ (ูุซุงู 1000)">
                    <button id="addPaymentBtn" class="btn success">ุฅูุฏุงุน</button>
                </div>
            </div>
        </div>
        
        <div id="paymentBadge" class="paymentBadge hidden"></div>

        <label class="lbl">ููุงุญุธุงุช (ุฐููุฉ ููุคุฑุฎุฉ)</label>
        <textarea id="stNotes" class="inp" rows="3" placeholder="ุงูุชุจ ููุญูุธุฉ ุฌุฏูุฏุฉ (ุณูุชู ุฅุถุงูุฉ ุงูุชุงุฑูุฎ ุชููุงุฆูุงู)..."></textarea>

        <div class="row wrap" style="margin-top:15px;">
          <button id="saveStudentBtn" class="btn primary">ุญูุธ ุงูุจูุงูุงุช ๐พ</button>
          <button id="markTodayBtn" class="btn success">โ ุญุถูุฑ</button>
          <button id="unmarkTodayBtn" class="btn warning">โ ุบูุงุจ</button>
          <button id="deleteStudentBtn" class="btn danger" style="background:#a41b25;">๐๏ธ ุญุฐู ุงูููู</button>
        </div>
        <div id="studentMsg" class="msg"></div>
      </div>

      <div class="card">
        <h2>ุณุฌู ุงูุชูุงุฑูุฎ (ุขุฎุฑ 25)</h2>
        <div id="attList" class="list mutedCenter">โ ุงูุชุญ ุทุงูุจ โ</div>
      </div>
    </div>

    <div class="card" id="recycleBinCard">
      <div class="flexBetween">
        <h2>โป๏ธ ุณูุฉ ุงููุญุฐููุงุช</h2>
        <button id="toggleBinBtn" class="btn smallBtn">ุนุฑุถ/ุฅุฎูุงุก</button>
      </div>
      <div id="recycleBinList" class="hidden list" style="margin-top:10px; border-top:1px solid #eee; padding-top:10px;">
        </div>
      <button id="emptyBinBtn" class="btn danger smallBtn hidden" style="margin-top:10px; width:100%;">๐ฅ ุชูุฑูุบ ุงูุณูุฉ ุชูุงูุงู</button>
    </div>

    <div class="card dangerZone">
      <h2>โ๏ธ ุฅุฏุงุฑุฉ ุงูุจูุงูุงุช (ููุทูุฉ ุงูุฎุทุฑ)</h2>
      <div class="dangerSection">
        <h3>1. ุจุฏุก ุชุฑู ุฌุฏูุฏ (ูุณุญ ุฌุฒุฆู)</h3>
        <div class="row">
          <input id="termPass" class="inp" type="password" placeholder="ูููุฉ ุงููุฑูุฑ">
          <button id="resetTermBtn" class="btn warning">ุชุตููุฑ ุงูุชุฑู</button>
        </div>
      </div>
      <hr style="margin:20px 0; border:0; border-top:1px solid #ddd;">
      <div class="dangerSection">
        <h3>2. ุฅุนุงุฏุฉ ุถุจุท ุงููุตูุน (ูุณุญ ููู)</h3>
        <div class="row">
          <input id="resetPass" class="inp" type="password" placeholder="ูููุฉ ุงููุฑูุฑ">
          <button id="resetBtn" class="btn danger">ูุณุญ ูู ุงูุจูุงูุงุช</button>
        </div>
      </div>
      <div id="resetMsg" class="msg"></div>
    </div>

  </div>

  <div id="allStudentsModal" class="modal hidden">
    <div class="modalContent">
      <div class="flexBetween">
        <h2>ูุงุฆูุฉ ุงูุทูุงุจ</h2>
        <button id="closeModalBtn" class="btn danger smallBtn">ุฅุบูุงู โ</button>
      </div>
      
      <div class="filtersRow" style="background:#f1f8ff; padding:10px; border-radius:8px; margin-bottom:10px; display:flex; gap:10px; flex-wrap:wrap;">
        <select id="filterGroup" class="inp" style="flex:1;">
            <option value="all">๐ ูู ุงููุฌููุนุงุช</option>
            </select>
        <select id="filterPayment" class="inp" style="flex:1;">
            <option value="all">๐ฐ ูู ุงูุญุงูุงุช ุงููุงููุฉ</option>
            <option value="paid">โ ุฎุงูุต ุงููุตุงุฑูู</option>
            <option value="partial">โ๏ธ ุนููู ูููุณ (ุจุงูู)</option>
            <option value="unpaid">๐ด ูู ูุฏูุน ุดูุฆุงู</option>
        </select>
      </div>

      <div class="tableWrap">
        <table id="allStudentsTable">
          <thead>
            <tr>
              <th>ID</th>
              <th>ุงูุงุณู</th>
              <th>ุงููุฌููุนุฉ</th>
              <th>ุงููุฏููุน</th>
              <th>ุงูุญุงูุฉ</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </div>
  </div>

  <script src="app.js?v=9"></script>
</body>
</html>
