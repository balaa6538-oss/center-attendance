<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Center System V13</title>
  <link rel="stylesheet" href="style.css?v=13">
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
</head>
<body>

  <div id="loginBox" class="card">
    <h1 data-i18n="login_title">ุฏุฎูู ููุญุฉ ุงูุณูุชุฑ</h1>
    <p class="muted" data-i18n="login_desc">ุงูุฏุฎูู ูููุณุคูู ููุท</p>
    <label class="lbl">Username</label>
    <input id="user" class="inp" type="text" placeholder="Admin">
    <label class="lbl">Password</label>
    <div class="passWrap">
      <input id="pass" class="inp" type="password" placeholder="Password">
      <button id="togglePass" class="eyeBtn" type="button">๐๏ธ</button>
    </div>
    <button id="loginBtn" class="btn primary" data-i18n="login_btn">ุฏุฎูู</button>
    <div id="loginMsg" class="msg"></div>
  </div>

  <div id="appBox" class="hidden">

    <div class="topbar">
      <div class="brand">
        <span data-i18n="brand_name">ููุญุฉ ุงูุณูุชุฑ</span>
        <div class="topStats">
          <span class="statItem clickable" id="openAllStudentsBtn">
            <span data-i18n="stat_students">๐ฅ ูุณุฌููู:</span> <b id="totalStudentsCount">0</b>
          </span>
          <span class="statItem">
            <span data-i18n="stat_attend">โ ุญุถูุฑ ุงูููู:</span> <b id="todayCountTop">0</b>
          </span>
          <span class="statItem">
            <span data-i18n="stat_revenue">๐ฐ ุฅูุฑุงุฏ ุงูููู:</span> <b id="todayRevenue">0</b>
          </span>
        </div>
      </div>

      <div class="topActions">
        <button id="langBtn" class="btn smallBtn" style="font-weight:bold;">EN</button>
        <button id="darkModeBtn" class="btn smallBtn">๐</button>
        
        <div class="termFeeWrapper">
          <span class="feeLabel" data-i18n="term_fee_label">ุงููุทููุจ:</span>
          <input id="termFeeInp" type="number" class="feeInp" placeholder="0">
          <button id="saveFeeBtn" class="feeBtn">๐</button>
        </div>

        <button id="exportExcelBtn" class="btn" data-i18n="btn_export">ุชุตุฏูุฑ Excel</button>
        <label class="btn fileBtn" for="importExcelInput" data-i18n="btn_import">ุงุณุชูุฑุงุฏ Excel</label>
        <input id="importExcelInput" type="file" accept=".xlsx,.xls" style="display:none;">
        <button id="logoutBtn" class="btn danger" data-i18n="btn_logout">ุฎุฑูุฌ</button>
      </div>
    </div>

    <div class="grid2">
      <div class="card">
        <h2 data-i18n="quick_title">ุณุฑูุน (QR)</h2>
        <div class="row">
          <input id="quickAttendId" class="inp" inputmode="numeric" placeholder="ID">
          <button id="quickAttendBtn" class="btn primary" data-i18n="btn_record">ุณุฌู ุญุถูุฑ</button>
        </div>
        <div id="quickMsg" class="msg"></div>
      </div>

      <div class="card">
        <h2 data-i18n="search_title">ุจุญุซ ุดุงูู</h2>
        <div class="row">
          <input id="openId" class="inp" inputmode="numeric" placeholder="ID">
          <button id="openBtn" class="btn" data-i18n="btn_open">ูุชุญ</button>
        </div>
        <div class="row">
          <input id="searchAny" class="inp" placeholder="...">
        </div>
        <div id="searchMsg" class="msg"></div>
      </div>
    </div>

    <div class="card">
      <h2 data-i18n="add_title">+ ุฅุถุงูุฉ ุทุงูุจ ุฌุฏูุฏ</h2>
      <div class="row">
        <input id="newId" class="inp" inputmode="numeric" placeholder="ID (ex: 601)">
        <button id="addNewBtn" class="btn" data-i18n="btn_add_open">ุฅุถุงูุฉ ููุชุญ</button>
      </div>
      <div id="addMsg" class="msg"></div>
    </div>

    <div class="card">
      <div class="flexBetween">
        <h2 data-i18n="report_title">ุญุถูุฑ ูุชูุฑูุฏ ุจุชุงุฑูุฎ</h2>
        <button id="copyReportBtn" class="btn success smallBtn" data-i18n="btn_copy_report">ูุณุฎ ุงูููุฎุต ๐</button>
      </div>
      <div class="row">
        <input id="reportDate" class="inp" type="date">
        <button id="reportBtn" class="btn" data-i18n="btn_show">ุนุฑุถ</button>
      </div>
      <div class="badges">
        <span class="badge"><span data-i18n="rep_date">ุงูุชุงุฑูุฎ:</span> <span id="reportDateLabel">โ</span></span>
        <span class="badge"><span data-i18n="rep_count">ุงูุนุฏุฏ:</span> <span id="reportCount">0</span></span>
        <span class="badge" style="color:#2ea44f;"><span data-i18n="rep_money">ุงูุฅูุฑุงุฏ:</span> <span id="reportMoney">0</span></span>
      </div>
      <div id="reportList" class="list mutedCenter">...</div>
    </div>

    <div class="grid2">
      <div class="card studentCard">
        <h2><span data-i18n="st_details">ุจูุงูุงุช ุงูุทุงูุจ</span> <span id="newBadge" class="newBadge hidden">ุฌุฏูุฏ</span></h2>

        <div class="studentHead">
          <div class="pill" id="studentIdPill">ID: โ</div>
          <div class="pill" id="todayStatus">โ</div>
          <div class="pill" id="lastAttend">โ</div>
          <div class="pill" id="daysCount">โ</div>
        </div>

        <label class="lbl" data-i18n="lbl_name">ุงูุงุณู</label>
        <input id="stName" class="inp">

        <label class="lbl" data-i18n="lbl_class">ุงูุตู / ุงููุฌููุนุฉ</label>
        <input id="stClass" class="inp">

        <label class="lbl" data-i18n="lbl_phone">ุฑูู ุงูููุจุงูู</label>
        <div class="row">
          <input id="stPhone" class="inp" inputmode="tel">
          <button id="waBtn" class="btn success">๐ฌ</button>
        </div>

        <label class="lbl" style="margin-top:20px; border-top:1px dashed #ccc; padding-top:10px;" data-i18n="lbl_finance">ูุธุงู ุงููุตุงุฑูู</label>
        <div class="paymentBox">
            <div class="payRow">
                <span class="payLabel" data-i18n="pay_total">๐ฐ ุฅุฌูุงูู ุงููุฏููุน:</span>
                <input id="stTotalPaid" class="inp" readonly style="background:#e9ecef; font-weight:bold; color:#2f6bff; width:100px; text-align:center;">
                <button id="correctPayBtn" class="btn warning smallBtn" data-i18n="btn_deduct">โ๏ธ ุฎุตู</button>
            </div>
            <div class="payRow">
                <span class="payLabel" data-i18n="pay_new">โ ุฏูุนุฉ ุฌุฏูุฏุฉ:</span>
                <div class="row" style="flex:1;">
                    <input id="newPaymentInput" type="number" class="inp">
                    <button id="addPaymentBtn" class="btn success" data-i18n="btn_deposit">ุฅูุฏุงุน</button>
                </div>
            </div>
        </div>
        <div id="paymentBadge" class="paymentBadge hidden"></div>

        <label class="lbl" data-i18n="lbl_notes">ููุงุญุธุงุช (ูุคุฑุฎุฉ)</label>
        <div class="row">
            <input id="newNoteInp" class="inp">
            <button id="addNoteBtn" class="btn" data-i18n="btn_add">ุฅุถุงูุฉ</button>
        </div>
        <textarea id="stNotes" class="inp" rows="3" readonly style="background:#f9f9f9; margin-top:5px; font-size:0.9em;"></textarea>

        <div class="row wrap" style="margin-top:15px;">
          <button id="saveStudentBtn" class="btn primary" data-i18n="btn_save">ุญูุธ ุงูุจูุงูุงุช ๐พ</button>
          <button id="markTodayBtn" class="btn success" data-i18n="btn_attend">โ ุญุถูุฑ</button>
          <button id="unmarkTodayBtn" class="btn warning" data-i18n="btn_absent">โ ุบูุงุจ</button>
          <button id="deleteStudentBtn" class="btn danger" style="margin-right:auto;" data-i18n="btn_delete">๐๏ธ ุญุฐู</button>
        </div>
        <div id="studentMsg" class="msg"></div>
      </div>

      <div class="card">
        <h2 data-i18n="history_title">ุณุฌู ุงูุชูุงุฑูุฎ</h2>
        <div id="attList" class="list mutedCenter">...</div>
      </div>
    </div>

    <div style="text-align: center; margin-top: 30px;">
        <button id="openBinBtn" class="btn" style="background:#444; color:#fff;" data-i18n="btn_recycle">โป๏ธ ุณูุฉ ุงููุญุฐููุงุช</button>
    </div>

    <div class="card dangerZone" style="margin-top:20px;">
      <h2 data-i18n="danger_title">โ๏ธ ุฅุฏุงุฑุฉ ุงูุจูุงูุงุช</h2>
      <div class="dangerSection">
        <h3 data-i18n="danger_term">1. ุชุตููุฑ ุงูุชุฑู</h3>
        <div class="row">
          <input id="termPass" class="inp" type="password">
          <button id="resetTermBtn" class="btn warning" data-i18n="btn_reset">ุชุตููุฑ</button>
        </div>
      </div>
      <hr>
      <div class="dangerSection">
        <h3 data-i18n="danger_factory">2. ุถุจุท ุงููุตูุน</h3>
        <div class="row">
          <input id="resetPass" class="inp" type="password">
          <button id="resetBtn" class="btn danger" data-i18n="btn_wipe">ูุณุญ ุงููู</button>
        </div>
      </div>
      <div id="resetMsg" class="msg"></div>
    </div>
  </div>

  <div id="allStudentsModal" class="modal hidden">
    <div class="modalContent">
      <div class="flexBetween">
        <h2 data-i18n="list_title">ูุงุฆูุฉ ุงูุทูุงุจ</h2>
        <button id="closeModalBtn" class="btn danger smallBtn">โ</button>
      </div>
      
      <div class="row" style="background:#f0f2f5; padding:10px; border-radius:8px; margin-bottom:10px;">
        <select id="filterClass" class="inp" style="width:auto;"></select>
        <select id="filterStatus" class="inp" style="width:auto;">
            <option value="all">-- Status / ุงูุญุงูุฉ --</option>
            <option value="paid">โ Paid</option>
            <option value="partial">โ๏ธ Partial</option>
            <option value="unpaid">๐ด Unpaid</option>
        </select>
      </div>

      <div class="tableWrap">
        <table id="allStudentsTable">
          <thead>
            <tr>
              <th>ID</th>
              <th data-i18n="th_name">ุงูุงุณู</th>
              <th data-i18n="th_class">ุงููุฌููุนุฉ</th>
              <th data-i18n="th_paid">ุงููุฏููุน</th>
              <th data-i18n="th_status">ุงูุญุงูุฉ</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </div>
  </div>

  <div id="recycleBinModal" class="modal hidden">
    <div class="modalContent" style="max-width:600px;">
      <div class="flexBetween">
        <h2 style="color:#d9534f;" data-i18n="bin_title">๐๏ธ ุณูุฉ ุงููุญุฐููุงุช</h2>
        <button id="closeBinBtn" class="btn smallBtn">X</button>
      </div>
      <div id="binList" class="list" style="max-height:400px; overflow-y:auto; margin-top:10px;"></div>
      <div style="margin-top:15px; text-align:right;">
          <button id="emptyBinBtn" class="btn danger" data-i18n="btn_empty_bin">ุฅูุฑุงุบ ุงูุณูุฉ ููุงุฆูุงู</button>
      </div>
    </div>
  </div>

  <script src="app.js?v=13"></script>
</body>
</html>
